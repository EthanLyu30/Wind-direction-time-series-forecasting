# ğŸŒ¬ï¸ é£é€Ÿåºåˆ—é¢„æµ‹ (Wind Speed Sequence Prediction)

[![Python](https://img.shields.io/badge/Python-3.8+-blue.svg)](https://www.python.org/downloads/)
[![PyTorch](https://img.shields.io/badge/PyTorch-2.0+-red.svg)](https://pytorch.org/)
[![License](https://img.shields.io/badge/License-MIT-green.svg)](LICENSE)

åŸºäºæ·±åº¦å­¦ä¹ çš„å¤šé«˜åº¦é£é€Ÿé¢„æµ‹ç³»ç»Ÿï¼Œæ”¯æŒå•æ­¥é¢„æµ‹ï¼ˆ8hâ†’1hï¼‰å’Œå¤šæ­¥é¢„æµ‹ï¼ˆ8hâ†’16hï¼‰ä»»åŠ¡ã€‚

## ğŸ“‹ é¡¹ç›®ç®€ä»‹

æœ¬é¡¹ç›®æ˜¯æœºå™¨å­¦ä¹ å®è·µè¯¾ç¨‹çš„æœŸæœ«å¤§ä½œä¸šï¼Œä½¿ç”¨æ¥è‡ª HuggingFace çš„é£é€Ÿæ•°æ®é›†ï¼ˆåŒ…å« 10ç±³ã€50ç±³ã€100ç±³ ä¸‰ä¸ªé«˜åº¦çš„ä¼ æ„Ÿå™¨æ•°æ®ï¼‰ï¼Œå®ç°äº†åŸºäºå¤šç§æ·±åº¦å­¦ä¹ æ¨¡å‹çš„é£é€Ÿé¢„æµ‹ä»»åŠ¡ã€‚

### æ ¸å¿ƒæˆæœ

| ä»»åŠ¡ | æœ€ä½³æ¨¡å‹ | RMSE | RÂ² | æ¨¡å‹ç±»å‹ |
|------|----------|------|-----|----------|
| å•æ­¥é¢„æµ‹ (8hâ†’1h) | LSTM | 0.9154 m/s | 0.8870 | åŸºç¡€ |
| å¤šæ­¥é¢„æµ‹ (8hâ†’16h) | WaveNet | 1.8555 m/s | 0.5375 | **åˆ›æ–°** |

### æ•°æ®é›†
- **æ•°æ®æ¥æº**: HuggingFace Datasets
  - [WindSpeed_10m](https://huggingface.co/datasets/Antajitters/WindSpeed_10m)
  - [WindSpeed_50m](https://huggingface.co/datasets/Antajitters/WindSpeed_50m)
  - [WindSpeed_100m](https://huggingface.co/datasets/Antajitters/WindSpeed_100m)
- **æ•°æ®ç‰¹å¾**: æ—¶é—´æˆ³ã€é£é€Ÿã€é£å‘ã€æ¸©åº¦ã€æ°”å‹ã€æ¹¿åº¦
- **æ•°æ®æ¡æ•°**: 10,573æ¡ï¼ˆæ¯ä¸ªé«˜åº¦ï¼‰
- **æ•°æ®å¤§å°**: çº¦257KB

## ğŸ—ï¸ é¡¹ç›®ç»“æ„

```
wind-speed-prediction/
â”œâ”€â”€ config.py                 # é…ç½®æ–‡ä»¶ï¼ˆè¶…å‚æ•°ã€è·¯å¾„é…ç½®ï¼‰
â”œâ”€â”€ data_loader.py           # æ•°æ®åŠ è½½ä¸é¢„å¤„ç†æ¨¡å—
â”œâ”€â”€ models.py                # åŸºç¡€æ¨¡å‹å®šä¹‰ï¼ˆLinearã€LSTMã€Transformerï¼‰
â”œâ”€â”€ models_innovative.py     # æ·±åº¦å­¦ä¹ åˆ›æ–°æ¨¡å‹ï¼ˆCNN-LSTMã€TCNã€WaveNetã€LSTNetï¼‰
â”œâ”€â”€ models_advanced.py       # é«˜çº§åˆ›æ–°æ¨¡å‹ï¼ˆHeightAttentionã€DLinearï¼‰
â”œâ”€â”€ models_simple.py         # ç‰©ç†çº¦æŸæ¨¡å‹ï¼ˆPersistenceã€WindShearã€TrendLinearï¼‰
â”œâ”€â”€ trainer.py               # è®­ç»ƒä¸è¯„ä¼°æ¨¡å—
â”œâ”€â”€ visualization.py         # å¯è§†åŒ–æ¨¡å—
â”œâ”€â”€ main.py                  # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ requirements.txt         # ä¾èµ–åŒ…åˆ—è¡¨
â”œâ”€â”€ README.md               # é¡¹ç›®è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ ANALYSIS.md             # è¯¦ç»†åˆ†ææŠ¥å‘Š
â”œâ”€â”€ dataset/                # æ•°æ®é›†ç›®å½•
â”œâ”€â”€ models/                 # ä¿å­˜çš„æ¨¡å‹æ–‡ä»¶ï¼ˆ24ä¸ª.pthæ–‡ä»¶ï¼‰
â”œâ”€â”€ results/                # å®éªŒç»“æœä¸å¯è§†åŒ–å›¾è¡¨
â”‚   â””â”€â”€ experiment_report.md # å®Œæ•´å®éªŒæŠ¥å‘Š
â””â”€â”€ logs/                   # è®­ç»ƒæ—¥å¿—
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚
- Python 3.8+
- PyTorch 2.0+
- CUDA (å¯é€‰ï¼Œç”¨äºGPUåŠ é€Ÿ)

### å®‰è£…ä¾èµ–

```bash
pip install -r requirements.txt
```

### è¿è¡Œå®éªŒ

```bash
# è¿è¡Œå®Œæ•´å®éªŒï¼ˆè®­ç»ƒæ‰€æœ‰æ¨¡å‹ + è¯„ä¼° + å¯è§†åŒ–ï¼‰
python main.py

# ä»…è®­ç»ƒæ¨¡å‹
python main.py --mode train

# ä»…è¯„ä¼°æ¨¡å‹ï¼ˆéœ€è¦å·²è®­ç»ƒçš„æ¨¡å‹ï¼‰
python main.py --mode eval
```

### ç»§ç»­è®­ç»ƒ/å¾®è°ƒ

```bash
# ç»§ç»­è®­ç»ƒæ‰€æœ‰æ¨¡å‹
python main.py --resume --epochs 300 --no-viz

# ç»§ç»­è®­ç»ƒç‰¹å®šä»»åŠ¡
python main.py --resume --tasks multistep_16h --epochs 400 --no-viz

# ç»§ç»­è®­ç»ƒç‰¹å®šæ¨¡å‹
python main.py --resume --models LSTM WaveNet --epochs 300 --no-viz
```

### GPUæœåŠ¡å™¨æ¨èé…ç½®

```bash
# A100/H100 (40GB+æ˜¾å­˜)
python main.py --batch-size 512 --epochs 300 --resume --no-viz

# RTX 3090/4090 (24GBæ˜¾å­˜)
python main.py --batch-size 256 --epochs 250 --resume --no-viz

# RTX 3060/3070 (8-12GBæ˜¾å­˜)
python main.py --batch-size 128 --epochs 200 --resume --no-viz
```

## ğŸ§  æ¨¡å‹ä»‹ç»

### åŸºç¡€æ¨¡å‹ (75%è¯„åˆ†è¦æ±‚)

| æ¨¡å‹ | æè¿° | å‚æ•°é‡ |
|------|------|--------|
| **Linear** | åŸºäºå¤šå±‚æ„ŸçŸ¥æœº(MLP)çš„çº¿æ€§æ¨¡å‹ | ~34K |
| **LSTM** | åŒå‘é•¿çŸ­æœŸè®°å¿†ç½‘ç»œï¼Œæ“…é•¿æ•è·æ—¶åºä¾èµ– | ~6M |
| **Transformer** | åŸºäºè‡ªæ³¨æ„åŠ›æœºåˆ¶çš„ç¼–ç å™¨-è§£ç å™¨æ¶æ„ | ~3M |

### åˆ›æ–°æ¨¡å‹ (25%åˆ›æ–°åˆ†)

æœ¬é¡¹ç›®å®ç°äº† **9ä¸ªåˆ›æ–°æ¨¡å‹**ï¼š

| æ¨¡å‹ | åˆ›æ–°ç‚¹ | æœ€ä½³åº”ç”¨åœºæ™¯ | å‚æ•°é‡ |
|------|--------|--------------|--------|
| **WaveNet** â­ | é—¨æ§æ¿€æ´» + è†¨èƒ€å› æœå·ç§¯ | **å¤šæ­¥é¢„æµ‹å† å†›** | ~350K |
| **HeightAttention** â­ | å¤šé«˜åº¦æ³¨æ„åŠ›æœºåˆ¶ | **å¤šæ­¥é¢„æµ‹äºšå†›** | ~200K |
| **DLinear** | è¶‹åŠ¿-å­£èŠ‚åˆ†è§£çº¿æ€§æ¨¡å‹ | å•æ­¥é¢„æµ‹äºšå†› | ~100 |
| **TCN** | å› æœå·ç§¯ + è†¨èƒ€å·ç§¯ | å•æ­¥é¢„æµ‹å­£å†› | ~100K |
| **CNN-LSTM** | å¤šå°ºåº¦CNN + LSTM | é€šç”¨ | ~300K |
| **LSTNet** | CNN + GRU + Skip-RNN | å‘¨æœŸæ€§æ•°æ® | ~150K |
| **WindShear** | åµŒå…¥é£åˆ‡å˜ç‰©ç†çº¦æŸ | ç‰©ç†å¯è§£é‡Š | ~20 |
| **TrendLinear** | HoltæŒ‡æ•°å¹³æ»‘å¯å‘ | è¶‹åŠ¿å¤–æ¨ | ~100 |
| **Persistence** | æŒä¹…æ€§åŸºçº¿ | åŸºå‡†å¯¹æ¯” | 6 |

## ğŸ“Š å®éªŒç»“æœ

### å•æ­¥é¢„æµ‹ (8hâ†’1h) - TOP 5

| æ’å | æ¨¡å‹ | RMSE â†“ | RÂ² â†‘ | ç±»å‹ |
|------|------|--------|------|------|
| ğŸ¥‡1 | **LSTM** | 0.9154 | 0.8870 | åŸºç¡€ |
| ğŸ¥ˆ2 | DLinear | 0.9162 | 0.8868 | åˆ›æ–° |
| ğŸ¥‰3 | TCN | 0.9163 | 0.8867 | åˆ›æ–° |
| 4 | HeightAttention | 0.9256 | 0.8844 | åˆ›æ–° |
| 5 | Linear | 0.9267 | 0.8841 | åŸºç¡€ |

### å¤šæ­¥é¢„æµ‹ (8hâ†’16h) - TOP 5

| æ’å | æ¨¡å‹ | RMSE â†“ | RÂ² â†‘ | ç±»å‹ |
|------|------|--------|------|------|
| ğŸ¥‡1 | **WaveNet** | 1.8555 | 0.5375 | åˆ›æ–° |
| ğŸ¥ˆ2 | HeightAttention | 1.8641 | 0.5332 | åˆ›æ–° |
| ğŸ¥‰3 | LSTM | 1.8853 | 0.5225 | åŸºç¡€ |
| 4 | Linear | 1.8928 | 0.5187 | åŸºç¡€ |
| 5 | TCN | 1.9017 | 0.5142 | åˆ›æ–° |

### å…³é”®å‘ç°

1. **åˆ›æ–°æ¨¡å‹ä»·å€¼**: åœ¨å¤šæ­¥é¢„æµ‹ä»»åŠ¡ä¸­ï¼Œåˆ›æ–°æ¨¡å‹ï¼ˆWaveNetã€HeightAttentionï¼‰æ˜¾è‘—è¶…è¶ŠåŸºç¡€æ¨¡å‹
2. **å­¦ä¹ ç‡é‡è¦æ€§**: å‘ç°å­¦ä¹ ç‡æ˜¯å½±å“æ¨¡å‹æ€§èƒ½çš„å…³é”®è¶…å‚æ•°ï¼Œè¿‡ä½ä¼šå¯¼è‡´æ¨¡å‹æ— æ³•æœ‰æ•ˆå­¦ä¹ 
3. **ä»»åŠ¡å·®å¼‚**: ä¸åŒä»»åŠ¡éœ€è¦ä¸åŒçš„æ¨¡å‹é€‰æ‹©ï¼ˆå•æ­¥é€‰LSTMï¼Œå¤šæ­¥é€‰WaveNetï¼‰

## ğŸ’¡ å®éªŒå†ç¨‹ä¸ç»éªŒ

### é‡åˆ°çš„æŒ‘æˆ˜

1. **ä»»åŠ¡ç†è§£åå·®**: åˆæœŸé”™è¯¯ç†è§£ä»»åŠ¡è¦æ±‚ï¼Œå¯¼è‡´éƒ¨åˆ†æ— ç”¨åŠŸ
2. **è®¡ç®—èµ„æºç“¶é¢ˆ**: æœ¬åœ°RTX 3060è®­ç»ƒé€Ÿåº¦æ…¢ï¼Œå•æ¨¡å‹éœ€2-3å°æ—¶
3. **è¶…å‚æ•°è°ƒä¼˜å›°éš¾**: å­¦ä¹ ç‡è®¾ç½®è¿‡ä½å¯¼è‡´åˆ›æ–°æ¨¡å‹è¡¨ç°ä¸ä½³

### è§£å†³æ–¹æ¡ˆ

1. **äº‘ç«¯è®­ç»ƒ**: ä½¿ç”¨æ™ºæ˜Ÿäº‘A100 GPUï¼ˆÂ¥2.19/å°æ—¶ï¼‰ï¼Œè®­ç»ƒé€Ÿåº¦æå‡10-15å€
2. **å­¦ä¹ ç‡è°ƒæ•´**: å‘ç°å¹¶ä¿®æ­£å­¦ä¹ ç‡é—®é¢˜ï¼Œåˆ›æ–°æ¨¡å‹æ€§èƒ½æ˜¾è‘—æå‡
3. **å……åˆ†è®­ç»ƒ**: å¤šä¸ªæ¨¡å‹è®­ç»ƒepochè¾¾åˆ°1000+ï¼Œç¡®ä¿å……åˆ†æ”¶æ•›

è¯¦ç»†çš„å®éªŒå†ç¨‹è¯·å‚é˜… [å®éªŒæŠ¥å‘Š](results/experiment_report.md)ã€‚

## ğŸ“ˆ è¯„ä¼°æŒ‡æ ‡

| æŒ‡æ ‡ | å…¬å¼ | æ¨èåº¦ |
|------|------|--------|
| **RMSE** | âˆš(MSE) | â­â­â­â­â­ (ä¸»è¦æŒ‡æ ‡) |
| **RÂ²** | 1 - SS_res/SS_tot | â­â­â­â­ (è¾…åŠ©æŒ‡æ ‡) |
| **MAE** | mean(\|y - Å·\|) | â­â­â­ |
| **MSE** | mean((y - Å·)Â²) | â­â­ |

**è§£è¯»å»ºè®®**: 
- RMSEä¸é£é€ŸåŒå•ä½ï¼ˆm/sï¼‰ï¼Œç›´è§‚æ˜“è§£é‡Š
- RÂ² > 0.8 ä¸ºä¼˜ç§€ï¼ŒRÂ² > 0.5 ä¸ºå¯æ¥å—

## ğŸ’¾ æ¨¡å‹æ–‡ä»¶

è®­ç»ƒå®Œæˆçš„æ¨¡å‹ä¿å­˜ä¸º `.pth` æ ¼å¼ï¼š

**åŸºç¡€æ¨¡å‹ï¼ˆ6ä¸ªï¼‰**: `{Linear,LSTM,Transformer}_{singlestep,multistep_16h}.pth`

**åˆ›æ–°æ¨¡å‹ï¼ˆ18ä¸ªï¼‰**: `{CNN_LSTM,TCN,WaveNet,LSTNet,DLinear,HeightAttention,TrendLinear,WindShear,Persistence}_{singlestep,multistep_16h}.pth`

**æ€»è®¡: 24ä¸ªæ¨¡å‹æ–‡ä»¶**

## ğŸ“ è¾“å‡ºæ–‡ä»¶

å®éªŒå®Œæˆåï¼Œåœ¨ `results/` ç›®å½•ç”Ÿæˆï¼š

- `experiment_report.md` - å®Œæ•´å®éªŒæŠ¥å‘Šï¼ˆ10-15é¡µï¼‰
- `model_comparison.csv` - æ¨¡å‹æ€§èƒ½å¯¹æ¯”è¡¨
- `dataset_overview.png` - æ•°æ®é›†æ¦‚è§ˆå›¾
- `model_performance_ranking.png` - æ¨¡å‹æ€§èƒ½æ’å
- `all_metrics_heatmap.png` - æ‰€æœ‰æŒ‡æ ‡çƒ­åŠ›å›¾
- å…¶ä»–å¯è§†åŒ–å›¾è¡¨...

## ğŸ“„ License

æœ¬é¡¹ç›®é‡‡ç”¨ MIT License - è¯¦è§ [LICENSE](LICENSE) æ–‡ä»¶

## ğŸ‘¥ ä½œè€…

è‹å·å¤§å­¦æœºå™¨å­¦ä¹ å®è·µè¯¾ç¨‹æœŸæœ«å¤§ä½œä¸š

## ğŸ™ è‡´è°¢

- [HuggingFace Datasets](https://huggingface.co/datasets) æä¾›æ•°æ®é›†
- [PyTorch](https://pytorch.org/) æ·±åº¦å­¦ä¹ æ¡†æ¶
- [æ™ºæ˜Ÿäº‘](https://gpu.ai-galaxy.cn/store) æä¾›é«˜æ€§ä»·æ¯”GPUç®—åŠ›

---

*æœ€åæ›´æ–°: 2025-12-30*
