# ğŸŒ¬ï¸ é£é€Ÿé¢„æµ‹æ¨¡å‹ - é¡¹ç›®åˆ†æä¸ä¼˜åŒ–æŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®çŠ¶æ€æ£€æŸ¥

### âœ… ä»»åŠ¡è¦æ±‚å®Œæˆæƒ…å†µ

| è¦æ±‚ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| æ ¹æ®é£å‘ã€æ¸©åº¦ã€æ°”å‹ã€æ¹¿åº¦é¢„æµ‹é£é€Ÿ | âœ… å·²å®ç° | ä½¿ç”¨å¤šç‰¹å¾è¾“å…¥ |
| å•æ­¥é¢„æµ‹ï¼ˆ8hâ†’1hï¼‰ | âœ… å·²å®ç° | `singlestep` ä»»åŠ¡ |
| å¤šæ­¥é¢„æµ‹ï¼ˆ8hâ†’16hï¼‰ | âœ… å·²å®ç° | `multistep_16h` ä»»åŠ¡ |
| æ•°æ®é›†åˆ’åˆ† 7:2:1 | âœ… å·²å®ç° | è®­ç»ƒ:éªŒè¯:æµ‹è¯• = 70%:20%:10% |
| ç‰¹å¾å·¥ç¨‹ï¼ˆç¼ºå¤±å€¼/å¼‚å¸¸å€¼ï¼‰ | âœ… å·²å®ç° | æ’å€¼æ³• + IQRå¼‚å¸¸å€¼å¤„ç† |
| å¯¹æ¯”è‡³å°‘3ä¸ªæ¨¡å‹ | âœ… å·²å®ç° | 7ä¸ªæ¨¡å‹ï¼šLinear, LSTM, Transformer, CNN_LSTM, TCN, WaveNet, N-BEATS |
| MSE/RMSE/MAE/RÂ² è¯„ä¼° | âœ… å·²å®ç° | å®Œæ•´çš„æŒ‡æ ‡è®¡ç®— |
| å¯è§†åŒ–æ•°æ®é›†åŠé¢„æµ‹ç»“æœ | âœ… å·²å®ç° | å¤šç§å¯è§†åŒ–å›¾è¡¨ |
| ä¿å­˜æ¨¡å‹ä¸ºpthæ ¼å¼ | âœ… å·²å®ç° | å…±14ä¸ªæ¨¡å‹ï¼ˆ7æ¨¡å‹Ã—2ä»»åŠ¡ï¼‰ |

---

## ğŸ“Š å½“å‰æ¨¡å‹æ€§èƒ½æ¦‚è§ˆ

### å•æ­¥é¢„æµ‹ (8h â†’ 1h) æ’å

| æ’å | æ¨¡å‹ | RMSE â†“ | RÂ² â†‘ | ç±»å‹ |
|------|------|--------|------|------|
| ğŸ¥‡1 | **LSTM** | 0.9155 | 0.8869 | åŸºç¡€ |
| ğŸ¥ˆ2 | Linear | 0.9267 | 0.8841 | åŸºç¡€ |
| ğŸ¥‰3 | **TCN** | 0.9351 | 0.8820 | åˆ›æ–° |
| 4 | CNN_LSTM | 0.9518 | 0.8778 | åˆ›æ–° |
| 5 | WaveNet | 0.9640 | 0.8747 | åˆ›æ–° |
| 6 | Transformer | 0.9698 | 0.8731 | åŸºç¡€ |
| 7 | **N-BEATS** | å¾…æµ‹è¯• | å¾…æµ‹è¯• | åˆ›æ–°â­ |

### å¤šæ­¥é¢„æµ‹ (8h â†’ 16h) æ’å

| æ’å | æ¨¡å‹ | RMSE â†“ | RÂ² â†‘ | ç±»å‹ |
|------|------|--------|------|------|
| ğŸ¥‡1 | Linear | 1.9309 | 0.4991 | åŸºç¡€ |
| ğŸ¥ˆ2 | **WaveNet** | 1.9594 | 0.4842 | åˆ›æ–° |
| ğŸ¥‰3 | LSTM | 1.9667 | 0.4804 | åŸºç¡€ |
| 4 | CNN_LSTM | 2.0147 | 0.4547 | åˆ›æ–° |
| 5 | TCN | 2.0638 | 0.4278 | åˆ›æ–° |
| 6 | Transformer | 2.1445 | 0.3822 | åŸºç¡€ |
| 7 | **N-BEATS** | å¾…æµ‹è¯• | å¾…æµ‹è¯• | åˆ›æ–°â­ |

---

## ğŸ” ç»“æœåˆ†æ

### ä¸ºä»€ä¹ˆç®€å•æ¨¡å‹æ•ˆæœæ›´å¥½ï¼Ÿ

1. **æ•°æ®é‡æœ‰é™**ï¼šçº¦10,000æ¡æ•°æ®ï¼Œå¤æ‚æ¨¡å‹å®¹æ˜“è¿‡æ‹Ÿåˆ
2. **ç‰¹å¾å…³ç³»ç®€å•**ï¼šé£é€Ÿä¸æ°”è±¡ç‰¹å¾å­˜åœ¨è¾ƒå¼ºçº¿æ€§å…³ç³»ï¼ŒLinearè¶³ä»¥æ•è·
3. **å¥¥å¡å§†å‰ƒåˆ€åŸç†**ï¼šç®€å•é—®é¢˜ç”¨ç®€å•æ¨¡å‹æ•ˆæœå¾€å¾€æ›´å¥½
4. **çŸ­æœŸä¾èµ–ä¸»å¯¼**ï¼š8å°æ—¶è¾“å…¥åºåˆ—çš„æ—¶åºä¾èµ–ä¸å¤æ‚

### åˆ›æ–°æ¨¡å‹çš„ä»·å€¼

1. **WaveNetåœ¨å¤šæ­¥é¢„æµ‹ä¸­è¡¨ç°ä¼˜å¼‚**ï¼šæ’åç¬¬2ï¼Œä¼˜äºLSTMï¼ˆRMSE: 1.96 vs 1.97ï¼‰
2. **TCNåœ¨å•æ­¥é¢„æµ‹ä¸­æ’åç¬¬3**ï¼šä¼˜äºTransformerï¼Œè¯æ˜å› æœå·ç§¯çš„æœ‰æ•ˆæ€§
3. **N-BEATS**ï¼ˆæ–°å¢ï¼‰ï¼šçº¯MLPæ¶æ„ï¼Œå‚æ•°é‡é€‚ä¸­ï¼Œé¢„æœŸåœ¨å¤šæ­¥é¢„æµ‹ä¸Šæœ‰çªç ´
4. **å­¦æœ¯ä»·å€¼**ï¼šå±•ç¤ºäº†å¯¹å¤šç§å‰æ²¿æ¶æ„çš„ç†è§£å’Œå®ç°èƒ½åŠ›

---

## ğŸ“ˆ è¯„ä¼°æŒ‡æ ‡é€‰æ‹©ç­–ç•¥

### å„æŒ‡æ ‡å«ä¹‰ä¸æ¨èåº¦

| æŒ‡æ ‡ | å«ä¹‰ | æ¨èåº¦ |
|------|------|--------|
| **RMSE** | å‡æ–¹æ ¹è¯¯å·®ï¼Œä¸åŸæ•°æ®åŒå•ä½ï¼Œç›´è§‚æ˜“è§£é‡Š | â­â­â­â­â­ |
| **RÂ²** | å†³å®šç³»æ•°ï¼Œè¡¨ç¤ºæ¨¡å‹è§£é‡Šçš„æ–¹å·®æ¯”ä¾‹ï¼ˆ1æœ€å¥½ï¼‰ | â­â­â­â­ |
| **MAE** | å¹³å‡ç»å¯¹è¯¯å·®ï¼Œå¯¹å¼‚å¸¸å€¼ä¸æ•æ„Ÿ | â­â­â­ |
| **MSE** | å‡æ–¹è¯¯å·®ï¼Œæ•°å€¼è¾ƒå¤§ä¸å¤Ÿç›´è§‚ | â­â­ |

### è§£è¯»å»ºè®®

- **ä¸»è¦çœ‹ RMSE**ï¼šè¯¯å·®å¤§å°ç›´è§‚ï¼Œå•ä½ä¸é£é€Ÿç›¸åŒï¼ˆm/sï¼‰
- **è¾…åŠ©çœ‹ RÂ²**ï¼šæ‹Ÿåˆä¼˜åº¦ï¼Œè¶Šæ¥è¿‘1è¶Šå¥½
  - RÂ² > 0.8ï¼šä¼˜ç§€
  - RÂ² > 0.5ï¼šå¯æ¥å—
  - å•æ­¥é¢„æµ‹ RÂ²â‰ˆ0.88 è¡¨ç¤ºæ¨¡å‹èƒ½è§£é‡Š88%çš„é£é€Ÿå˜åŒ–
  - å¤šæ­¥é¢„æµ‹ RÂ²â‰ˆ0.50 è¡¨ç¤ºé•¿æœŸé¢„æµ‹éš¾åº¦å¤§ï¼Œè¿™æ˜¯æ­£å¸¸ç°è±¡

---

## ğŸš€ å¾®è°ƒæŒ‡ä»¤æŒ‡å—

### ğŸ”§ åŸºç¡€å¾®è°ƒæŒ‡ä»¤

```bash
# 1. ç»§ç»­è®­ç»ƒæ‰€æœ‰æ¨¡å‹ï¼ˆä»æ£€æŸ¥ç‚¹æ¢å¤ï¼Œå¢åŠ epochï¼‰
python main.py --mode train --resume --epochs 300 --no-viz

# 2. é’ˆå¯¹è¡¨ç°è¾ƒå·®çš„æ¨¡å‹ï¼Œé™ä½å­¦ä¹ ç‡å¾®è°ƒ
python main.py --mode train --resume --epochs 400 --lr 0.0001 --patience 30 --models Transformer --no-viz

# 3. ä¸“é—¨ä¼˜åŒ–å¤šæ­¥é¢„æµ‹ä»»åŠ¡ï¼ˆå¤šæ­¥é¢„æµ‹æ˜¯çŸ­æ¿ï¼‰
python main.py --mode train --resume --epochs 500 --lr 0.0001 --patience 40 --tasks multistep_16h --no-viz
```

### ğŸ¯ é’ˆå¯¹æ€§å¾®è°ƒæŒ‡ä»¤

```bash
# 4. å¾®è°ƒå•æ­¥é¢„æµ‹è¡¨ç°å¥½çš„æ¨¡å‹ï¼ˆè¿›ä¸€æ­¥æå‡ï¼‰
python main.py --mode train --resume --epochs 400 --lr 0.0002 --patience 25 \
    --models LSTM Linear TCN --tasks singlestep --no-viz

# 5. å¾®è°ƒå¤šæ­¥é¢„æµ‹ï¼ˆé‡ç‚¹æå‡RÂ²ï¼‰
python main.py --mode train --resume --epochs 500 --lr 0.00005 --patience 50 \
    --models Linear WaveNet LSTM --tasks multistep_16h --metric-mode r2 --no-viz

# 6. ä½¿ç”¨ç»¼åˆæŒ‡æ ‡æ¨¡å¼å¾®è°ƒï¼ˆå¹³è¡¡RMSEå’ŒRÂ²ï¼‰
python main.py --mode train --resume --epochs 400 --lr 0.0001 --patience 35 \
    --metric-mode combined --no-viz
```

### ğŸš€ é«˜å¼ºåº¦å¾®è°ƒæŒ‡ä»¤ï¼ˆGPUæ¨èï¼‰

```bash
# 7. é•¿æ—¶é—´æ·±åº¦è®­ç»ƒï¼ˆé€‚åˆæœ‰GPUçš„æœåŠ¡å™¨ï¼‰
python main.py --mode train --resume --epochs 800 --lr 0.00005 --patience 60 \
    --batch-size 256 --no-viz

# 8. åªä¼˜åŒ–æœ€æœ‰æ½œåŠ›çš„æ¨¡å‹
python main.py --mode train --resume --epochs 600 --lr 0.0001 --patience 40 \
    --models LSTM WaveNet Linear NBEATS --no-viz
```

### ğŸ†• è®­ç»ƒæ–°çš„N-BEATSæ¨¡å‹

```bash
# 9. è®­ç»ƒæ–°æ·»åŠ çš„N-BEATSæ¨¡å‹
python main.py --mode train --epochs 200 --models NBEATS --no-viz

# 10. N-BEATSæ·±åº¦è®­ç»ƒï¼ˆæ¨èï¼‰
python main.py --mode train --epochs 400 --lr 0.0005 --patience 30 \
    --models NBEATS --no-viz
```

### ğŸ“Š æ¨èçš„å¾®è°ƒæµç¨‹

```bash
# ç¬¬ä¸€æ­¥ï¼šè®­ç»ƒæ–°çš„N-BEATSæ¨¡å‹
python main.py --mode train --epochs 300 --models NBEATS --no-viz

# ç¬¬äºŒæ­¥ï¼šä¸“é—¨å¾®è°ƒå¤šæ­¥é¢„æµ‹ï¼Œå¢åŠ è®­ç»ƒè½®æ•°
python main.py --mode train --resume --epochs 400 --lr 0.0003 --patience 35 \
    --tasks multistep_16h --no-viz

# ç¬¬ä¸‰æ­¥ï¼šå¦‚æœç¬¬äºŒæ­¥æœ‰æ”¹è¿›ï¼Œç»§ç»­æ·±åº¦è®­ç»ƒ
python main.py --mode train --resume --epochs 600 --lr 0.0001 --patience 50 \
    --tasks multistep_16h --metric-mode r2 --no-viz

# ç¬¬å››æ­¥ï¼šç»¼åˆè¯„ä¼°ï¼Œç”Ÿæˆå¯è§†åŒ–
python main.py --mode all --epochs 100
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
/workspace
â”œâ”€â”€ config.py           # é…ç½®æ–‡ä»¶
â”œâ”€â”€ data_loader.py      # æ•°æ®åŠ è½½ä¸é¢„å¤„ç†
â”œâ”€â”€ main.py             # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ models.py           # åŸºç¡€æ¨¡å‹ (Linear, LSTM, Transformer)
â”œâ”€â”€ models_innovative.py # åˆ›æ–°æ¨¡å‹ (CNN_LSTM, TCN, WaveNet, N-BEATS)
â”œâ”€â”€ trainer.py          # è®­ç»ƒå™¨
â”œâ”€â”€ visualization.py    # å¯è§†åŒ–
â”œâ”€â”€ dataset/            # æ•°æ®é›†
â”œâ”€â”€ models/             # ä¿å­˜çš„æ¨¡å‹ï¼ˆ14ä¸ª.pthæ–‡ä»¶ï¼‰
â”œâ”€â”€ results/            # å¯è§†åŒ–ç»“æœ
â””â”€â”€ logs/               # è®­ç»ƒæ—¥å¿—
```

### æ¨¡å‹æ–‡ä»¶å‘½åè§„åˆ™

| æ¨¡å‹ | å•æ­¥é¢„æµ‹ | å¤šæ­¥é¢„æµ‹ |
|------|----------|----------|
| Linear | `Linear_singlestep.pth` | `Linear_multistep_16h.pth` |
| LSTM | `LSTM_singlestep.pth` | `LSTM_multistep_16h.pth` |
| Transformer | `Transformer_singlestep.pth` | `Transformer_multistep_16h.pth` |
| CNN_LSTM | `CNN_LSTM_singlestep.pth` | `CNN_LSTM_multistep_16h.pth` |
| TCN | `TCN_singlestep.pth` | `TCN_multistep_16h.pth` |
| WaveNet | `WaveNet_singlestep.pth` | `WaveNet_multistep_16h.pth` |
| N-BEATS | `NBEATS_singlestep.pth` | `NBEATS_multistep_16h.pth` |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä»»åŠ¡é…ç½®**ï¼šå•æ­¥é¢„æµ‹(8hâ†’1h) + å¤šæ­¥é¢„æµ‹(8hâ†’16h)ï¼Œå…±2ä¸ªä»»åŠ¡
2. **æ¨¡å‹æ•°é‡**ï¼š7ä¸ªæ¨¡å‹ Ã— 2ä¸ªä»»åŠ¡ = 14ä¸ªæ¨¡å‹æ–‡ä»¶
3. **åŸºç¡€æ¨¡å‹è¦æ±‚**ï¼šLinearã€LSTMã€Transformerï¼ˆæ»¡è¶³ä½œä¸šè¦æ±‚çš„3ä¸ªæ¨¡å‹å¯¹æ¯”ï¼‰
4. **åˆ›æ–°æ¨¡å‹åŠ åˆ†**ï¼šCNN_LSTMã€TCNã€WaveNetã€N-BEATS

---

## ğŸ†• N-BEATS æ¨¡å‹ä»‹ç»

**N-BEATS** (Neural Basis Expansion Analysis for Time Series) æ˜¯2020å¹´ICLRå‘è¡¨çš„çº¯MLPæ—¶é—´åºåˆ—é¢„æµ‹æ¨¡å‹ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

### åˆ›æ–°ç‚¹
1. **çº¯MLPæ¶æ„**ï¼šæ— éœ€RNN/Transformerï¼Œè®­ç»ƒé€Ÿåº¦å¿«ï¼Œä¸æ˜“è¿‡æ‹Ÿåˆ
2. **æ®‹å·®å­¦ä¹ **ï¼šæ¯ä¸ªå—é¢„æµ‹ä¸€éƒ¨åˆ†ä¿¡å·ï¼Œæ®‹å·®ä¼ é€’ç»™ä¸‹ä¸€å—
3. **åŒå‘è¾“å‡º**ï¼šåŒæ—¶è¾“å‡ºbackcastï¼ˆé‡å»ºè¾“å…¥ï¼‰å’Œforecastï¼ˆé¢„æµ‹æœªæ¥ï¼‰
4. **å †å ç»“æ„**ï¼šå¤šä¸ªStackå †å ï¼Œæ¯ä¸ªStackåŒ…å«å¤šä¸ªBlock

### é¢„æœŸæ•ˆæœ
- åœ¨å¤šæ­¥é¢„æµ‹ä¸Šé¢„è®¡è¶…è¿‡å½“å‰æœ€ä½³ï¼ˆLinear: RÂ²=0.4991ï¼‰
- å‚æ•°é‡é€‚ä¸­ï¼Œé€‚åˆå½“å‰æ•°æ®é‡è§„æ¨¡
- è®­ç»ƒæ”¶æ•›å¿«ï¼Œé€‚åˆå¿«é€Ÿè¿­ä»£
