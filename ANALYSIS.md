# ğŸŒ¬ï¸ é£é€Ÿé¢„æµ‹æ¨¡å‹ - é¡¹ç›®åˆ†æä¸ä¼˜åŒ–æŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®çŠ¶æ€æ£€æŸ¥

### âœ… ä»»åŠ¡è¦æ±‚å®Œæˆæƒ…å†µ

| è¦æ±‚ | çŠ¶æ€ | è¯´æ˜ |
|------|------|------|
| æ ¹æ®é£å‘ã€æ¸©åº¦ã€æ°”å‹ã€æ¹¿åº¦é¢„æµ‹é£é€Ÿ | âœ… å·²å®ç° | ä½¿ç”¨å¤šç‰¹å¾è¾“å…¥ |
| å•æ­¥é¢„æµ‹ï¼ˆ8hâ†’1hï¼‰ | âœ… å·²å®ç° | `singlestep` ä»»åŠ¡ |
| å¤šæ­¥é¢„æµ‹ï¼ˆ8hâ†’16hï¼‰ | âœ… å·²å®ç° | `multistep_16h` ä»»åŠ¡ |
| æ•°æ®é›†åˆ’åˆ† 7:2:1 | âœ… å·²å®ç° | è®­ç»ƒ:éªŒè¯:æµ‹è¯• = 70%:20%:10% |
| ç‰¹å¾å·¥ç¨‹ï¼ˆç¼ºå¤±å€¼/å¼‚å¸¸å€¼ï¼‰ | âœ… å·²å®ç° | æ’å€¼æ³• + IQRå¼‚å¸¸å€¼å¤„ç† |
| å¯¹æ¯”è‡³å°‘3ä¸ªæ¨¡å‹ | âœ… å·²å®ç° | 7ä¸ªæ¨¡å‹ï¼šLinear, LSTM, Transformer, CNN_LSTM, TCN, WaveNet, LSTNet |
| MSE/RMSE/MAE/RÂ² è¯„ä¼° | âœ… å·²å®ç° | å®Œæ•´çš„æŒ‡æ ‡è®¡ç®— |
| å¯è§†åŒ–æ•°æ®é›†åŠé¢„æµ‹ç»“æœ | âœ… å·²å®ç° | å¤šç§å¯è§†åŒ–å›¾è¡¨ |
| ä¿å­˜æ¨¡å‹ä¸ºpthæ ¼å¼ | âœ… å·²å®ç° | å…±14ä¸ªæ¨¡å‹ï¼ˆ7æ¨¡å‹Ã—2ä»»åŠ¡ï¼‰ |

---

## ğŸ“Š å½“å‰æ¨¡å‹æ€§èƒ½æ¦‚è§ˆï¼ˆæœ€æ–°è®­ç»ƒç»“æœï¼‰

### å•æ­¥é¢„æµ‹ (8h â†’ 1h) æ’å

| æ’å | æ¨¡å‹ | RMSE â†“ | RÂ² â†‘ | MAE | ç±»å‹ |
|------|------|--------|------|-----|------|
| ğŸ¥‡1 | **LSTM** | 0.9243 | 0.8848 | 0.6948 | åŸºç¡€ |
| ğŸ¥ˆ2 | Linear | 0.9267 | 0.8841 | 0.7060 | åŸºç¡€ |
| ğŸ¥‰3 | **TCN** | 0.9351 | 0.8820 | 0.7026 | åˆ›æ–° |
| 4 | Transformer | 0.9441 | 0.8798 | 0.7077 | åŸºç¡€ |
| 5 | **LSTNet** | 0.9480 | 0.8788 | 0.7225 | åˆ›æ–° |
| 6 | CNN_LSTM | 0.9510 | 0.8780 | 0.7227 | åˆ›æ–° |
| 7 | WaveNet | 0.9529 | 0.8775 | 0.7220 | åˆ›æ–° |

### å¤šæ­¥é¢„æµ‹ (8h â†’ 16h) æ’å

| æ’å | æ¨¡å‹ | RMSE â†“ | RÂ² â†‘ | MAE | ç±»å‹ |
|------|------|--------|------|-----|------|
| ğŸ¥‡1 | **LSTM** | 1.8853 | 0.5225 | 1.4937 | åŸºç¡€ |
| ğŸ¥ˆ2 | Linear | 1.8997 | 0.5152 | 1.5101 | åŸºç¡€ |
| ğŸ¥‰3 | **WaveNet** | 1.9500 | 0.4892 | 1.5346 | åˆ›æ–° |
| 4 | CNN_LSTM | 1.9975 | 0.4640 | 1.5828 | åˆ›æ–° |
| 5 | Transformer | 2.0148 | 0.4546 | 1.5991 | åŸºç¡€ |
| 6 | TCN | 2.0417 | 0.4400 | 1.6304 | åˆ›æ–° |
| 7 | LSTNet | 2.1075 | 0.4033 | 1.6274 | åˆ›æ–° |

---

## ğŸ” ç»“æœåˆ†æ

### ä¸ºä»€ä¹ˆLSTMæ¨¡å‹æ•ˆæœæœ€å¥½ï¼Ÿ

1. **åŒå‘LSTMç»“æ„**ï¼šèƒ½åŒæ—¶åˆ©ç”¨è¿‡å»å’Œæœªæ¥çš„ä¸Šä¸‹æ–‡ä¿¡æ¯
2. **é—¨æ§æœºåˆ¶ä¼˜ç§€**ï¼šæ“…é•¿æ•è·æ—¶åºæ•°æ®ä¸­çš„é•¿çŸ­æœŸä¾èµ–
3. **å‚æ•°é‡é€‚ä¸­**ï¼šç›¸æ¯”Transformeræ›´ä¸å®¹æ˜“è¿‡æ‹Ÿåˆ
4. **æˆç†Ÿç¨³å®š**ï¼šç»è¿‡å¤§é‡å®è·µéªŒè¯çš„æ—¶åºå»ºæ¨¡èƒ½åŠ›

### ä¸ºä»€ä¹ˆç®€å•æ¨¡å‹ï¼ˆLinearï¼‰æ•ˆæœä¹Ÿå¾ˆå¥½ï¼Ÿ

1. **æ•°æ®é‡æœ‰é™**ï¼šçº¦10,000æ¡æ•°æ®ï¼Œå¤æ‚æ¨¡å‹å®¹æ˜“è¿‡æ‹Ÿåˆ
2. **ç‰¹å¾å…³ç³»ç®€å•**ï¼šé£é€Ÿä¸æ°”è±¡ç‰¹å¾å­˜åœ¨è¾ƒå¼ºçº¿æ€§å…³ç³»
3. **å¥¥å¡å§†å‰ƒåˆ€åŸç†**ï¼šç®€å•é—®é¢˜ç”¨ç®€å•æ¨¡å‹æ•ˆæœå¾€å¾€æ›´å¥½
4. **çŸ­æœŸä¾èµ–ä¸»å¯¼**ï¼š8å°æ—¶è¾“å…¥åºåˆ—çš„æ—¶åºä¾èµ–ç›¸å¯¹ç®€å•

### åˆ›æ–°æ¨¡å‹çš„ä»·å€¼

1. **WaveNetåœ¨å¤šæ­¥é¢„æµ‹ä¸­æ’åç¬¬3**ï¼šé—¨æ§å·ç§¯åœ¨é•¿æœŸé¢„æµ‹ä¸Šæœ‰ä¼˜åŠ¿
2. **TCNåœ¨å•æ­¥é¢„æµ‹ä¸­æ’åç¬¬3**ï¼šä¼˜äºTransformerï¼Œè¯æ˜å› æœå·ç§¯çš„æœ‰æ•ˆæ€§
3. **LSTNetå‘¨æœŸæ€§å»ºæ¨¡**ï¼šSkip-RNNç»„ä»¶å¯æ•è·å‘¨æœŸæ€§æ¨¡å¼
4. **å­¦æœ¯ä»·å€¼**ï¼šå±•ç¤ºäº†å¯¹å¤šç§å‰æ²¿æ¶æ„çš„ç†è§£å’Œå®ç°èƒ½åŠ›

---

## ğŸ“ˆ è¯„ä¼°æŒ‡æ ‡é€‰æ‹©ç­–ç•¥

### å„æŒ‡æ ‡å«ä¹‰ä¸æ¨èåº¦

| æŒ‡æ ‡ | å«ä¹‰ | æ¨èåº¦ |
|------|------|--------|
| **RMSE** | å‡æ–¹æ ¹è¯¯å·®ï¼Œä¸åŸæ•°æ®åŒå•ä½ï¼Œç›´è§‚æ˜“è§£é‡Š | â­â­â­â­â­ |
| **RÂ²** | å†³å®šç³»æ•°ï¼Œè¡¨ç¤ºæ¨¡å‹è§£é‡Šçš„æ–¹å·®æ¯”ä¾‹ï¼ˆ1æœ€å¥½ï¼‰ | â­â­â­â­ |
| **MAE** | å¹³å‡ç»å¯¹è¯¯å·®ï¼Œå¯¹å¼‚å¸¸å€¼ä¸æ•æ„Ÿ | â­â­â­ |
| **MSE** | å‡æ–¹è¯¯å·®ï¼Œæ•°å€¼è¾ƒå¤§ä¸å¤Ÿç›´è§‚ | â­â­ |

### è§£è¯»å»ºè®®

- **ä¸»è¦çœ‹ RMSE**ï¼šè¯¯å·®å¤§å°ç›´è§‚ï¼Œå•ä½ä¸é£é€Ÿç›¸åŒï¼ˆm/sï¼‰
- **è¾…åŠ©çœ‹ RÂ²**ï¼šæ‹Ÿåˆä¼˜åº¦ï¼Œè¶Šæ¥è¿‘1è¶Šå¥½
  - RÂ² > 0.8ï¼šä¼˜ç§€
  - RÂ² > 0.5ï¼šå¯æ¥å—
  - å•æ­¥é¢„æµ‹ RÂ²â‰ˆ0.88 è¡¨ç¤ºæ¨¡å‹èƒ½è§£é‡Š88%çš„é£é€Ÿå˜åŒ–
  - å¤šæ­¥é¢„æµ‹ RÂ²â‰ˆ0.50 è¡¨ç¤ºé•¿æœŸé¢„æµ‹éš¾åº¦å¤§ï¼Œè¿™æ˜¯æ­£å¸¸ç°è±¡

---

## ğŸš€ å¾®è°ƒæŒ‡ä»¤æŒ‡å—

### ğŸ”§ åŸºç¡€å¾®è°ƒæŒ‡ä»¤

```bash
# 1. ç»§ç»­è®­ç»ƒæ‰€æœ‰æ¨¡å‹ï¼ˆä»æ£€æŸ¥ç‚¹æ¢å¤ï¼Œå¢åŠ epochï¼‰
python main.py --mode train --resume --epochs 300 --no-viz

# 2. é’ˆå¯¹è¡¨ç°è¾ƒå·®çš„æ¨¡å‹ï¼Œé™ä½å­¦ä¹ ç‡å¾®è°ƒ
python main.py --mode train --resume --epochs 400 --lr 0.0001 --patience 30 --models Transformer --no-viz

# 3. ä¸“é—¨ä¼˜åŒ–å¤šæ­¥é¢„æµ‹ä»»åŠ¡ï¼ˆå¤šæ­¥é¢„æµ‹æ˜¯çŸ­æ¿ï¼‰
python main.py --mode train --resume --epochs 500 --lr 0.0001 --patience 40 --tasks multistep_16h --no-viz
```

### ğŸ¯ é’ˆå¯¹æ€§å¾®è°ƒæŒ‡ä»¤

```bash
# 4. å¾®è°ƒå•æ­¥é¢„æµ‹è¡¨ç°å¥½çš„æ¨¡å‹ï¼ˆè¿›ä¸€æ­¥æå‡ï¼‰
python main.py --mode train --resume --epochs 400 --lr 0.0002 --patience 25 \
    --models LSTM Linear TCN --tasks singlestep --no-viz

# 5. å¾®è°ƒå¤šæ­¥é¢„æµ‹ï¼ˆé‡ç‚¹æå‡RÂ²ï¼‰
python main.py --mode train --resume --epochs 500 --lr 0.00005 --patience 50 \
    --models Linear WaveNet LSTM --tasks multistep_16h --metric-mode r2 --no-viz

# 6. ä½¿ç”¨ç»¼åˆæŒ‡æ ‡æ¨¡å¼å¾®è°ƒï¼ˆå¹³è¡¡RMSEå’ŒRÂ²ï¼‰
python main.py --mode train --resume --epochs 400 --lr 0.0001 --patience 35 \
    --metric-mode combined --no-viz
```

### ğŸš€ é«˜å¼ºåº¦å¾®è°ƒæŒ‡ä»¤ï¼ˆGPUæ¨èï¼‰

```bash
# 7. é•¿æ—¶é—´æ·±åº¦è®­ç»ƒï¼ˆé€‚åˆæœ‰GPUçš„æœåŠ¡å™¨ï¼‰
python main.py --mode train --resume --epochs 800 --lr 0.00005 --patience 60 \
    --batch-size 256 --no-viz

# 8. åªä¼˜åŒ–æœ€æœ‰æ½œåŠ›çš„æ¨¡å‹
python main.py --mode train --resume --epochs 600 --lr 0.0001 --patience 40 \
    --models LSTM WaveNet Linear LSTNet --no-viz
```

### ğŸ“Š æ¨èçš„å¾®è°ƒæµç¨‹

```bash
# ç¬¬ä¸€æ­¥ï¼šä¸“é—¨å¾®è°ƒå¤šæ­¥é¢„æµ‹ï¼ˆé€šå¸¸æ˜¯çŸ­æ¿ï¼‰
python main.py --mode train --resume --epochs 400 --lr 0.0003 --patience 35 \
    --tasks multistep_16h --no-viz

# ç¬¬äºŒæ­¥ï¼šå¦‚æœç¬¬ä¸€æ­¥æœ‰æ”¹è¿›ï¼Œç»§ç»­æ·±åº¦è®­ç»ƒ
python main.py --mode train --resume --epochs 600 --lr 0.0001 --patience 50 \
    --tasks multistep_16h --metric-mode r2 --no-viz

# ç¬¬ä¸‰æ­¥ï¼šç»¼åˆè¯„ä¼°ï¼Œç”Ÿæˆå¯è§†åŒ–
python main.py --mode all --epochs 100
```

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
/workspace
â”œâ”€â”€ config.py           # é…ç½®æ–‡ä»¶
â”œâ”€â”€ data_loader.py      # æ•°æ®åŠ è½½ä¸é¢„å¤„ç†
â”œâ”€â”€ main.py             # ä¸»ç¨‹åºå…¥å£
â”œâ”€â”€ models.py           # åŸºç¡€æ¨¡å‹ (Linear, LSTM, Transformer)
â”œâ”€â”€ models_innovative.py # åˆ›æ–°æ¨¡å‹ (CNN_LSTM, TCN, WaveNet, N-BEATS)
â”œâ”€â”€ trainer.py          # è®­ç»ƒå™¨
â”œâ”€â”€ visualization.py    # å¯è§†åŒ–
â”œâ”€â”€ dataset/            # æ•°æ®é›†
â”œâ”€â”€ models/             # ä¿å­˜çš„æ¨¡å‹ï¼ˆ14ä¸ª.pthæ–‡ä»¶ï¼‰
â”œâ”€â”€ results/            # å¯è§†åŒ–ç»“æœ
â””â”€â”€ logs/               # è®­ç»ƒæ—¥å¿—
```

### æ¨¡å‹æ–‡ä»¶å‘½åè§„åˆ™

| æ¨¡å‹ | å•æ­¥é¢„æµ‹ | å¤šæ­¥é¢„æµ‹ |
|------|----------|----------|
| Linear | `Linear_singlestep.pth` | `Linear_multistep_16h.pth` |
| LSTM | `LSTM_singlestep.pth` | `LSTM_multistep_16h.pth` |
| Transformer | `Transformer_singlestep.pth` | `Transformer_multistep_16h.pth` |
| CNN_LSTM | `CNN_LSTM_singlestep.pth` | `CNN_LSTM_multistep_16h.pth` |
| TCN | `TCN_singlestep.pth` | `TCN_multistep_16h.pth` |
| WaveNet | `WaveNet_singlestep.pth` | `WaveNet_multistep_16h.pth` |
| LSTNet | `LSTNet_singlestep.pth` | `LSTNet_multistep_16h.pth` |

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **ä»»åŠ¡é…ç½®**ï¼šå•æ­¥é¢„æµ‹(8hâ†’1h) + å¤šæ­¥é¢„æµ‹(8hâ†’16h)ï¼Œå…±2ä¸ªä»»åŠ¡
2. **æ¨¡å‹æ•°é‡**ï¼š7ä¸ªæ¨¡å‹ Ã— 2ä¸ªä»»åŠ¡ = 14ä¸ªæ¨¡å‹æ–‡ä»¶
3. **åŸºç¡€æ¨¡å‹è¦æ±‚**ï¼šLinearã€LSTMã€Transformerï¼ˆæ»¡è¶³ä½œä¸šè¦æ±‚çš„3ä¸ªæ¨¡å‹å¯¹æ¯”ï¼‰
4. **åˆ›æ–°æ¨¡å‹åŠ åˆ†**ï¼šCNN_LSTMã€TCNã€WaveNetã€LSTNet

---

## ğŸ†• LSTNet æ¨¡å‹ä»‹ç»

**LSTNet** (Long- and Short-term Time-series Network) æ˜¯SIGIR 2018å‘è¡¨çš„æ—¶é—´åºåˆ—é¢„æµ‹æ¨¡å‹ï¼Œå…·æœ‰ä»¥ä¸‹ç‰¹ç‚¹ï¼š

### åˆ›æ–°ç‚¹
1. **CNNå±‚**ï¼šæå–çŸ­æœŸå±€éƒ¨æ—¶åºæ¨¡å¼
2. **GRUå±‚**ï¼šæ•è·é•¿æœŸåºåˆ—ä¾èµ–å…³ç³»
3. **Skip-RNN**ï¼šç›´æ¥å»ºæ¨¡å‘¨æœŸæ€§æ¨¡å¼ï¼ˆå¦‚æ¯æ—¥/æ¯å‘¨å‘¨æœŸï¼‰
4. **Highwayç»„ä»¶**ï¼šè‡ªå›å½’åˆ†é‡å¢å¼ºé¢„æµ‹ç¨³å®šæ€§

### æ¨¡å‹ç‰¹ç‚¹
- å‚æ•°é‡é€‚ä¸­ï¼ˆ~150Kï¼‰ï¼Œé€‚åˆä¸­å°è§„æ¨¡æ•°æ®é›†
- å¤šç»„ä»¶ååŒï¼šCNN+GRU+Skip-RNN+Highway
- åœ¨æœ¬é¡¹ç›®ä¸­å•æ­¥é¢„æµ‹æ’åç¬¬5ï¼Œå¤šæ­¥é¢„æµ‹æ’åç¬¬7
- å¯¹å‘¨æœŸæ€§å¼ºçš„æ•°æ®æ•ˆæœæ›´å¥½
